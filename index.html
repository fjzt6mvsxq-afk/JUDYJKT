<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Oscar & Judy's Jakarta Trip</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #fcfcf5; /* å»¶ä¼¸åœ–ç‰‡åº•è‰² */
            -webkit-tap-highlight-color: transparent;
        }
        /* éš±è— Scrollbar ä½†ä¿ç•™åŠŸèƒ½ */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        /* æ¨¡æ“¬ App é™°å½±èˆ‡åœ“è§’ */
        .app-card {
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            border-radius: 16px;
        }
        .tab-active {
            color: #d97706; /* Amber-600 */
            border-bottom: 2px solid #d97706;
        }
        /* è½‰å ´å‹•ç•« */
        .fade-enter-active, .fade-leave-active {
            transition: opacity 0.3s ease;
        }
        .fade-enter-from, .fade-leave-to {
            opacity: 0;
        }
    </style>
</head>
<body class="bg-[#fafaf0] text-slate-800">

<div id="app" class="relative min-h-screen pb-24">

    <div class="relative bg-slate-800 h-64 w-full overflow-hidden">
        <img src="https://images.unsplash.com/photo-1555899434-94d1368d7dd6?q=80&w=1000&auto=format&fit=crop" class="w-full h-full object-cover opacity-80" alt="Jakarta">
        
        <div class="absolute top-0 left-0 w-full h-full bg-gradient-to-b from-transparent to-slate-900/80"></div>
        
        <div class="absolute bottom-20 left-6 text-white">
            <h1 class="text-2xl font-bold">Jakarta Trip ğŸ‡®ğŸ‡©</h1>
            <p class="text-sm opacity-90">Oscar & Judy's Adventure</p>
            <p class="text-xs mt-1 text-yellow-400">Dec 12 - Dec 15, 2025</p>
        </div>

        <div class="absolute bottom-4 right-4 flex space-x-4">
            <button @click="currentTab = 'itinerary'" :class="{'text-yellow-400 scale-110': currentTab === 'itinerary'}" class="flex flex-col items-center text-white/70 transition hover:text-white">
                <i class="fa-solid fa-map-location-dot text-xl mb-1"></i>
                <span class="text-[10px]">è¡Œç¨‹</span>
            </button>
            <button @click="currentTab = 'info'" :class="{'text-yellow-400 scale-110': currentTab === 'info'}" class="flex flex-col items-center text-white/70 transition hover:text-white">
                <i class="fa-solid fa-circle-info text-xl mb-1"></i>
                <span class="text-[10px]">è³‡è¨Š</span>
            </button>
            <button @click="currentTab = 'shopping'" :class="{'text-yellow-400 scale-110': currentTab === 'shopping'}" class="flex flex-col items-center text-white/70 transition hover:text-white">
                <i class="fa-solid fa-basket-shopping text-xl mb-1"></i>
                <span class="text-[10px]">æ¸…å–®</span>
            </button>
            <button @click="currentTab = 'expense'" :class="{'text-yellow-400 scale-110': currentTab === 'expense'}" class="flex flex-col items-center text-white/70 transition hover:text-white">
                <i class="fa-solid fa-coins text-xl mb-1"></i>
                <span class="text-[10px]">èŠ±è²»</span>
            </button>
        </div>
    </div>

    <div class="relative -mt-6 bg-[#fafaf0] rounded-t-[30px] px-4 pt-6 min-h-[calc(100vh-200px)] z-10 shadow-[0_-5px_20px_rgba(0,0,0,0.1)]">

        <div v-if="currentTab === 'itinerary'">
            
            <div class="flex overflow-x-auto no-scrollbar space-x-3 mb-6 pb-2">
                <div v-for="(day, index) in days" :key="index" 
                     @click="selectedDayIndex = index"
                     :class="selectedDayIndex === index ? 'bg-yellow-500 text-white shadow-lg scale-105' : 'bg-white text-slate-400'"
                     class="flex-shrink-0 w-16 h-20 rounded-2xl flex flex-col items-center justify-center transition-all duration-300 cursor-pointer border border-gray-100">
                    <span class="text-xs font-medium uppercase">{{ day.weekday }}</span>
                    <span class="text-2xl font-bold">{{ day.date }}</span>
                </div>
            </div>

            <div class="bg-gradient-to-r from-blue-400 to-blue-300 rounded-2xl p-4 text-white mb-6 flex items-center justify-between shadow-md">
                <div>
                    <div class="text-sm opacity-90">Jakarta, ID</div>
                    <div class="text-3xl font-bold mt-1">31Â°C</div>
                    <div class="text-xs mt-1">é«”æ„Ÿ 36Â°C â€¢ æ¿•åº¦é«˜</div>
                </div>
                <div class="text-4xl">
                    <i class="fa-solid fa-cloud-sun"></i>
                </div>
            </div>

            <div class="space-y-4">
                <div v-for="(item, index) in filteredItinerary" :key="item.id" class="relative pl-4 border-l-2 border-dashed border-gray-300 last:border-0">
                    
                    <div v-if="index > 0 || (index === 0 && selectedDayIndex > 0)" class="absolute -left-[19px] -top-6 bg-gray-100 text-gray-500 text-[10px] px-2 py-1 rounded-full border border-gray-200 flex items-center gap-1">
                        <i class="fa-solid fa-person-walking"></i>
                        <span>ç´„ {{ item.travelTime || '15' }} min</span>
                    </div>

                    <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-100 relative group transition active:scale-95">
                        <span :class="getCategoryColor(item.category)" class="absolute top-3 right-3 text-[10px] font-bold px-2 py-0.5 rounded-full text-white">
                            {{ item.category }}
                        </span>

                        <div class="flex items-start gap-3" @click="openMap(item.name)">
                            <div class="mt-1 text-slate-700">
                                <i :class="getCategoryIcon(item.category)" class="text-lg"></i>
                            </div>
                            <div class="flex-1">
                                <h3 class="font-bold text-gray-800 leading-tight">{{ item.name }}</h3>
                                <div class="text-xs text-gray-500 mt-1 flex items-center gap-2">
                                    <span v-if="item.time" class="bg-slate-100 px-1.5 py-0.5 rounded text-slate-600 font-mono">{{ item.time }}</span>
                                    <span v-if="item.duration">â± {{ item.duration }}</span>
                                </div>
                                <div v-if="item.notes" class="text-xs text-gray-500 mt-2 bg-yellow-50/50 p-2 rounded border border-yellow-100">
                                    {{ item.notes }}
                                </div>
                            </div>
                            <div class="text-gray-300">
                                <i class="fa-solid fa-chevron-right text-xs"></i>
                            </div>
                        </div>

                        <div class="flex justify-end mt-3 pt-2 border-t border-gray-50 gap-3">
                            <button @click.stop="moveItem(index, -1)" class="text-gray-400 hover:text-blue-500 text-xs"><i class="fa-solid fa-arrow-up"></i></button>
                            <button @click.stop="moveItem(index, 1)" class="text-gray-400 hover:text-blue-500 text-xs"><i class="fa-solid fa-arrow-down"></i></button>
                            <button @click.stop="deleteItineraryItem(item.id)" class="text-gray-400 hover:text-red-500 text-xs"><i class="fa-solid fa-trash"></i></button>
                        </div>
                    </div>
                </div>

                <div v-if="filteredItinerary.length === 0" class="text-center text-gray-400 py-10">
                    <i class="fa-solid fa-map-pin text-3xl mb-2"></i>
                    <p>ä»Šå¤©é‚„æ²’æœ‰è¡Œç¨‹å®‰æ’</p>
                </div>
            </div>

            <button @click="showAddModal = true" class="fixed bottom-6 right-6 bg-slate-800 text-white w-14 h-14 rounded-full shadow-xl flex items-center justify-center text-2xl z-50 active:scale-90 transition">
                <i class="fa-solid fa-plus"></i>
            </button>
        </div>


        <div v-if="currentTab === 'info'" class="space-y-6 pb-20">
            <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-100">
                <h3 class="font-bold text-slate-700 mb-4 border-l-4 border-yellow-500 pl-3">åŒ¯ç‡æ›ç®— (IDR â‡„ HKD)</h3>
                <div class="flex items-center gap-2 mb-3">
                    <div class="flex-1">
                        <label class="text-xs text-gray-400 block mb-1">å°å°¼ç›¾ (IDR)</label>
                        <input type="number" v-model="calcIDR" @input="convertCurrency('IDR')" class="w-full bg-gray-50 rounded-lg p-3 font-mono font-bold text-lg outline-none focus:ring-2 focus:ring-yellow-400" placeholder="0">
                    </div>
                    <i class="fa-solid fa-arrow-right-arrow-left text-gray-300"></i>
                    <div class="flex-1">
                        <label class="text-xs text-gray-400 block mb-1">æ¸¯å¹£ (HKD)</label>
                        <input type="number" v-model="calcHKD" @input="convertCurrency('HKD')" class="w-full bg-gray-50 rounded-lg p-3 font-mono font-bold text-lg outline-none focus:ring-2 focus:ring-yellow-400" placeholder="0">
                    </div>
                </div>
                <p class="text-[10px] text-gray-400 text-center">åŒ¯ç‡ä¼°ç®—: 1 HKD â‰ˆ 2,050 IDR</p>
            </div>

            <div class="bg-white rounded-2xl shadow-sm overflow-hidden">
                <div class="bg-slate-800 text-white p-3 px-5 flex justify-between items-center">
                    <span class="font-bold"><i class="fa-solid fa-plane-departure mr-2"></i>å»ç¨‹</span>
                    <span class="text-xs bg-white/20 px-2 py-1 rounded">12 Dec</span>
                </div>
                <div class="p-5">
                    <div class="flex justify-between items-center mb-2">
                        <div class="text-2xl font-bold">HKG</div>
                        <i class="fa-solid fa-plane text-slate-300"></i>
                        <div class="text-2xl font-bold">CGK</div>
                    </div>
                    <div class="flex justify-between text-sm text-gray-500">
                        <span>19:05</span>
                        <span>03h 55m</span>
                        <span>23:00</span>
                    </div>
                    <div class="mt-3 pt-3 border-t border-gray-100 text-center text-sm font-bold text-slate-700">
                        CX 797 (åœ‹æ³°èˆªç©º)
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-2xl shadow-sm overflow-hidden">
                <div class="bg-indigo-600 text-white p-3 px-5">
                    <span class="font-bold"><i class="fa-solid fa-hotel mr-2"></i>ä½å®¿é£¯åº—</span>
                </div>
                <div class="p-5">
                    <h3 class="font-bold text-lg">Pullman Jakarta Thamrin</h3>
                    <p class="text-sm text-gray-500 mt-1"><i class="fa-solid fa-location-dot mr-1"></i> Jl. M.H. Thamrin No.59, Jakarta</p>
                    <div class="mt-4 flex gap-2">
                        <button @click="openMap('Pullman Jakarta Thamrin')" class="flex-1 bg-gray-100 text-slate-700 py-2 rounded-lg text-sm font-medium hover:bg-gray-200">å°èˆª</button>
                        <a href="tel:+622131921111" class="flex-1 bg-gray-100 text-slate-700 py-2 rounded-lg text-sm font-medium hover:bg-gray-200 text-center">æ’¥æ‰“é›»è©±</a>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div class="bg-white p-4 rounded-xl shadow-sm text-center">
                    <i class="fa-solid fa-car text-2xl text-green-500 mb-2"></i>
                    <h4 class="font-bold text-sm">ç§Ÿè»Šè³‡è¨Š</h4>
                    <p class="text-xs text-gray-400 mt-1">å°šæœªè¨­å®š</p>
                </div>
                <div class="bg-white p-4 rounded-xl shadow-sm text-center">
                    <i class="fa-solid fa-truck-medical text-2xl text-red-500 mb-2"></i>
                    <h4 class="font-bold text-sm">ç·Šæ€¥æ±‚åŠ©</h4>
                    <p class="text-xs text-gray-400 mt-1">112 (é€šç”¨)</p>
                </div>
            </div>
        </div>


        <div v-if="currentTab === 'shopping'" class="pb-20">
            <h3 class="font-bold text-slate-700 mb-4 border-l-4 border-yellow-500 pl-3">è³¼ç‰©æ¸…å–®</h3>
            
            <div class="grid grid-cols-2 gap-4">
                <div v-for="(item, index) in shoppingList" :key="index" class="bg-white p-3 rounded-xl shadow-sm flex flex-col relative">
                    <button @click="deleteShoppingItem(index)" class="absolute top-2 right-2 text-gray-300 hover:text-red-500"><i class="fa-solid fa-xmark"></i></button>
                    <div class="h-24 bg-gray-100 rounded-lg mb-2 overflow-hidden flex items-center justify-center text-gray-300">
                        <img v-if="item.image" :src="item.image" class="w-full h-full object-cover">
                        <i v-else class="fa-solid fa-image text-2xl"></i>
                    </div>
                    <div class="font-bold text-sm truncate">{{ item.name }}</div>
                    <div class="text-xs text-gray-400">é è¨ˆ: {{ item.location || 'æœªå®š' }}</div>
                </div>
            </div>

             <button @click="showShoppingModal = true" class="fixed bottom-6 right-6 bg-yellow-500 text-white w-14 h-14 rounded-full shadow-xl flex items-center justify-center text-2xl z-50 active:scale-90 transition">
                <i class="fa-solid fa-plus"></i>
            </button>
        </div>


        <div v-if="currentTab === 'expense'" class="pb-20">
            <div class="bg-slate-800 text-white p-6 rounded-2xl shadow-lg mb-6">
                <div class="text-sm opacity-70">ç¸½æ”¯å‡º (Total)</div>
                <div class="text-3xl font-bold mt-1 font-mono">HKD {{ totalExpenseHKD }}</div>
                <div class="text-xs mt-2 text-yellow-400">â‰ˆ IDR {{ (totalExpenseHKD * 2050).toLocaleString() }}</div>
            </div>

            <div class="bg-white rounded-2xl shadow-sm overflow-hidden">
                <div class="p-4 border-b border-gray-100 font-bold text-slate-700">æ”¯å‡ºç´€éŒ„</div>
                <div class="divide-y divide-gray-100">
                    <div v-for="(exp, index) in expenses" :key="index" class="p-4 flex justify-between items-center">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-slate-500">
                                <i :class="getExpenseIcon(exp.category)"></i>
                            </div>
                            <div>
                                <div class="font-bold text-sm text-slate-800">{{ exp.name }}</div>
                                <div class="text-xs text-gray-400">{{ exp.date }} â€¢ {{ exp.payment }}</div>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="font-bold text-slate-800 font-mono">HKD {{ exp.amount }}</div>
                            <button @click="deleteExpense(index)" class="text-[10px] text-red-400 underline mt-1">åˆªé™¤</button>
                        </div>
                    </div>
                    <div v-if="expenses.length === 0" class="p-8 text-center text-gray-400 text-sm">
                        å°šæœªæœ‰æ”¯å‡ºç´€éŒ„
                    </div>
                </div>
            </div>

            <button @click="showExpenseModal = true" class="fixed bottom-6 right-6 bg-green-600 text-white w-14 h-14 rounded-full shadow-xl flex items-center justify-center text-2xl z-50 active:scale-90 transition">
                <i class="fa-solid fa-plus"></i>
            </button>
        </div>

    </div>

    <div v-if="showAddModal" class="fixed inset-0 z-50 flex items-end sm:items-center justify-center pointer-events-none">
        <div class="absolute inset-0 bg-black/50 pointer-events-auto" @click="showAddModal = false"></div>
        <div class="bg-white w-full sm:w-96 p-6 rounded-t-2xl sm:rounded-2xl pointer-events-auto animate-slide-up">
            <h3 class="font-bold text-lg mb-4">æ–°å¢è¡Œç¨‹</h3>
            <div class="space-y-3">
                <input v-model="newItem.name" placeholder="è¡Œç¨‹åç¨± (ä¾‹å¦‚: å»åƒæ™šé¤)" class="w-full border p-2 rounded-lg">
                <select v-model="newItem.category" class="w-full border p-2 rounded-lg">
                    <option value="æ™¯é»">æ™¯é»</option>
                    <option value="ç¾é£Ÿ">ç¾é£Ÿ</option>
                    <option value="è³¼ç‰©">è³¼ç‰©</option>
                    <option value="ä½å®¿">ä½å®¿</option>
                    <option value="äº¤é€š">äº¤é€š</option>
                </select>
                <div class="flex gap-2">
                    <input type="time" v-model="newItem.startTime" class="border p-2 rounded-lg flex-1">
                    <input type="time" v-model="newItem.endTime" class="border p-2 rounded-lg flex-1">
                </div>
                <input v-model="newItem.notes" placeholder="å‚™è¨»/ç‰¹è‰²" class="w-full border p-2 rounded-lg">
                <button @click="addNewItinerary" class="w-full bg-slate-800 text-white py-3 rounded-xl font-bold mt-2">ç¢ºèªæ–°å¢</button>
            </div>
        </div>
    </div>

    <div v-if="showShoppingModal" class="fixed inset-0 z-50 flex items-end sm:items-center justify-center pointer-events-none">
        <div class="absolute inset-0 bg-black/50 pointer-events-auto" @click="showShoppingModal = false"></div>
        <div class="bg-white w-full sm:w-96 p-6 rounded-t-2xl sm:rounded-2xl pointer-events-auto">
            <h3 class="font-bold text-lg mb-4">æ–°å¢è³¼ç‰©é …ç›®</h3>
            <div class="space-y-3">
                <input v-model="newShop.name" placeholder="å•†å“åç¨±" class="w-full border p-2 rounded-lg">
                <input v-model="newShop.location" placeholder="é è¨ˆè³¼è²·åœ°é»" class="w-full border p-2 rounded-lg">
                <label class="block bg-gray-100 p-3 rounded-lg text-center cursor-pointer">
                    <span class="text-sm text-gray-500"><i class="fa-solid fa-camera mr-2"></i>ä¸Šå‚³åœ–ç‰‡</span>
                    <input type="file" @change="handleImageUpload" class="hidden" accept="image/*">
                </label>
                <div v-if="newShop.image" class="h-20 w-full bg-gray-100 rounded overflow-hidden">
                    <img :src="newShop.image" class="w-full h-full object-cover">
                </div>
                <button @click="addShoppingItem" class="w-full bg-yellow-500 text-white py-3 rounded-xl font-bold">åŠ å…¥æ¸…å–®</button>
            </div>
        </div>
    </div>

    <div v-if="showExpenseModal" class="fixed inset-0 z-50 flex items-end sm:items-center justify-center pointer-events-none">
        <div class="absolute inset-0 bg-black/50 pointer-events-auto" @click="showExpenseModal = false"></div>
        <div class="bg-white w-full sm:w-96 p-6 rounded-t-2xl sm:rounded-2xl pointer-events-auto">
            <h3 class="font-bold text-lg mb-4">è¨˜å¸³</h3>
            <div class="space-y-3">
                <input v-model="newExpense.name" placeholder="é …ç›®åç¨±" class="w-full border p-2 rounded-lg">
                <input type="number" v-model="newExpense.amount" placeholder="é‡‘é¡ (HKD)" class="w-full border p-2 rounded-lg">
                <select v-model="newExpense.category" class="w-full border p-2 rounded-lg">
                    <option value="äº¤é€š">äº¤é€š</option>
                    <option value="é£²é£Ÿ">é£²é£Ÿ</option>
                    <option value="è³¼ç‰©">è³¼ç‰©</option>
                    <option value="ä½å®¿">ä½å®¿</option>
                    <option value="å…¶ä»–">å…¶ä»–</option>
                </select>
                <select v-model="newExpense.payment" class="w-full border p-2 rounded-lg">
                    <option value="ç¾é‡‘">ç¾é‡‘</option>
                    <option value="ä¿¡ç”¨å¡">ä¿¡ç”¨å¡</option>
                </select>
                <button @click="addExpense" class="w-full bg-green-600 text-white py-3 rounded-xl font-bold">å„²å­˜</button>
            </div>
        </div>
    </div>

</div>

<script>
    const { createApp } = Vue;

    createApp({
        data() {
            return {
                currentTab: 'itinerary',
                selectedDayIndex: 0,
                showAddModal: false,
                showShoppingModal: false,
                showExpenseModal: false,
                
                // åŒ¯ç‡
                calcIDR: '',
                calcHKD: '',
                rate: 0.00049, // 1 IDR = 0.00049 HKD (ç´„ç•¥)

                // åˆå§‹è¡Œç¨‹è³‡æ–™ (ä¾æ“šåœ–ç‰‡è½‰éŒ„)
                days: [
                    { weekday: 'Fri', date: '12', fullDate: '2025-12-12' },
                    { weekday: 'Sat', date: '13', fullDate: '2025-12-13' },
                    { weekday: 'Sun', date: '14', fullDate: '2025-12-14' },
                    { weekday: 'Mon', date: '15', fullDate: '2025-12-15' }
                ],
                itinerary: [
                    // Day 1 (12 Dec)
                    { id: 1, date: '2025-12-12', name: 'HKG - CGK (CX 797)', time: '19:05 - 23:00', duration: '03h 55m', category: 'äº¤é€š', notes: 'åœ‹æ³°èˆªç©º', travelTime: '' },
                    { id: 2, date: '2025-12-12', name: 'Immigrations & Luggage', time: '23:00 - 23:45', duration: '45m', category: 'å…¶ä»–', notes: '', travelTime: '0 min' },
                    { id: 3, date: '2025-12-12', name: 'Check In Pullman Jakarta', time: '23:45 - 01:00', duration: '1h 15m', category: 'ä½å®¿', notes: 'PULLMAN Jakarta Thamrin', travelTime: '45 min' },

                    // Day 2 (13 Dec)
                    { id: 4, date: '2025-12-13', name: 'Bakmi Krekot', time: '09:00 - 10:30', duration: '1h 30m', category: 'ç¾é£Ÿ', notes: 'æ—©é¤', travelTime: '30 min' },
                    { id: 5, date: '2025-12-13', name: 'Sarinah', time: '10:30 - 12:45', duration: '2h 15m', category: 'è³¼ç‰©', notes: 'Hunting Batik', travelTime: '30 min' },
                    { id: 6, date: '2025-12-13', name: 'Lekko (Grand Indonesia)', time: '12:45 - 14:00', duration: '1h 15m', category: 'ç¾é£Ÿ', notes: 'Lunch', travelTime: '15 min' },
                    { id: 7, date: '2025-12-13', name: 'Ranch Market & Food Hall', time: '14:00 - 15:30', duration: '1h 30m', category: 'è³¼ç‰©', notes: 'Visit Supermarket', travelTime: '15 min' },
                    { id: 8, date: '2025-12-13', name: 'Hotel Rest', time: '16:00 - 19:00', duration: '3h', category: 'ä½å®¿', notes: 'Prepare for Wedding', travelTime: '30 min' },
                    { id: 9, date: '2025-12-13', name: 'Wedding Party', time: '19:00 - 21:00', duration: '2h', category: 'å…¶ä»–', notes: 'Wedding', travelTime: '30 min' },

                    // Day 3 (14 Dec)
                    { id: 10, date: '2025-12-14', name: 'Soto Gubeng', time: '09:00 - 10:30', duration: '1h 30m', category: 'ç¾é£Ÿ', notes: 'æ—©é¤', travelTime: '30 min' },
                    { id: 11, date: '2025-12-14', name: 'Market City PIK', time: '10:30 - 12:15', duration: '1h 45m', category: 'è³¼ç‰©', notes: 'Explore Supermarket', travelTime: '45 min' },
                    { id: 12, date: '2025-12-14', name: 'Bandar Djakarta PIK', time: '12:15 - 14:00', duration: '1h 45m', category: 'ç¾é£Ÿ', notes: 'Lunch æµ·é®®', travelTime: '15 min' },
                    { id: 13, date: '2025-12-14', name: 'Lotte Grosir Kelapa Gading', time: '14:00 - 16:00', duration: '2h', category: 'è³¼ç‰©', notes: 'Wholesaler', travelTime: '60 min' },
                    { id: 14, date: '2025-12-14', name: 'Grand Lucky', time: '16:00 - 17:45', duration: '1h 45m', category: 'è³¼ç‰©', notes: 'Supermarket', travelTime: '45 min' },
                    { id: 15, date: '2025-12-14', name: 'Pagi Sore Cipete', time: '17:45 - 19:30', duration: '1h 45m', category: 'ç¾é£Ÿ', notes: 'Dinner', travelTime: '30 min' },

                     // Day 4 (15 Dec)
                     { id: 16, date: '2025-12-15', name: 'Bakmi ABUN Gang Kelinci', time: '09:00 - 10:30', duration: '1h 30m', category: 'ç¾é£Ÿ', notes: 'Pasar Baru æ—©é¤', travelTime: '30 min' },
                     { id: 17, date: '2025-12-15', name: 'Airport (CGK)', time: '11:30 - 21:30', duration: '-', category: 'äº¤é€š', notes: 'OTW Airport & Flight', travelTime: '60 min' }
                ],
                
                // æ–°å¢é …ç›®æš«å­˜å€
                newItem: { name: '', category: 'æ™¯é»', startTime: '', endTime: '', notes: '' },
                newShop: { name: '', location: '', image: null },
                newExpense: { name: '', amount: '', category: 'é£²é£Ÿ', payment: 'ç¾é‡‘' },

                // è³‡æ–™å®¹å™¨
                shoppingList: [],
                expenses: []
            }
        },
        computed: {
            // æ ¹æ“šé¸ä¸­çš„æ—¥æœŸéæ¿¾è¡Œç¨‹
            filteredItinerary() {
                const targetDate = this.days[this.selectedDayIndex].fullDate;
                return this.itinerary.filter(item => item.date === targetDate);
            },
            totalExpenseHKD() {
                return this.expenses.reduce((sum, item) => sum + Number(item.amount), 0);
            }
        },
        created() {
            // å˜—è©¦å¾ localStorage è®€å–èˆŠè³‡æ–™
            const savedShopping = localStorage.getItem('jakarta_shopping');
            if (savedShopping) this.shoppingList = JSON.parse(savedShopping);
            
            const savedExpenses = localStorage.getItem('jakarta_expenses');
            if (savedExpenses) this.expenses = JSON.parse(savedExpenses);

            // å¦‚æœæœ‰è‡ªå®šç¾©æ–°å¢çš„è¡Œç¨‹ï¼Œä¹Ÿå¯ä»¥å­˜å–
            const savedItinerary = localStorage.getItem('jakarta_itinerary');
            if (savedItinerary) this.itinerary = JSON.parse(savedItinerary);
        },
        methods: {
            saveData() {
                localStorage.setItem('jakarta_shopping', JSON.stringify(this.shoppingList));
                localStorage.setItem('jakarta_expenses', JSON.stringify(this.expenses));
                localStorage.setItem('jakarta_itinerary', JSON.stringify(this.itinerary));
            },
            
            // è¡Œç¨‹ç›¸é—œ
            getCategoryColor(cat) {
                const map = { 'æ™¯é»': 'bg-blue-500', 'ä½å®¿': 'bg-indigo-500', 'ç¾é£Ÿ': 'bg-orange-500', 'è³¼ç‰©': 'bg-pink-500', 'äº¤é€š': 'bg-slate-500', 'å…¶ä»–': 'bg-gray-400' };
                return map[cat] || 'bg-gray-400';
            },
            getCategoryIcon(cat) {
                const map = { 'æ™¯é»': 'fa-camera', 'ä½å®¿': 'fa-bed', 'ç¾é£Ÿ': 'fa-utensils', 'è³¼ç‰©': 'fa-bag-shopping', 'äº¤é€š': 'fa-plane', 'å…¶ä»–': 'fa-circle' };
                return `fa-solid ${map[cat] || 'fa-circle'}`;
            },
            openMap(location) {
                // é–‹å•Ÿ Google Maps æœå°‹è©²åœ°é»
                window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(location + " Jakarta")}`, '_blank');
            },
            moveItem(index, direction) {
                const list = this.filteredItinerary;
                const item = list[index];
                const realIndex = this.itinerary.indexOf(item);
                
                // æ‰¾å‡ºåˆ—è¡¨ä¸­ä¸Šä¸€å€‹æˆ–ä¸‹ä¸€å€‹é …ç›®çš„çœŸå¯¦ç´¢å¼•
                const targetListIndex = index + direction;
                if (targetListIndex < 0 || targetListIndex >= list.length) return;
                
                const targetItem = list[targetListIndex];
                const targetRealIndex = this.itinerary.indexOf(targetItem);

                // äº¤æ›ä½ç½®
                [this.itinerary[realIndex], this.itinerary[targetRealIndex]] = [this.itinerary[targetRealIndex], this.itinerary[realIndex]];
                this.saveData();
            },
            deleteItineraryItem(id) {
                if(confirm('ç¢ºå®šè¦åˆªé™¤æ­¤è¡Œç¨‹å—ï¼Ÿ')) {
                    this.itinerary = this.itinerary.filter(i => i.id !== id);
                    this.saveData();
                }
            },
            addNewItinerary() {
                if(!this.newItem.name) return alert('è«‹è¼¸å…¥åç¨±');
                
                const targetDate = this.days[this.selectedDayIndex].fullDate;
                const timeStr = (this.newItem.startTime && this.newItem.endTime) ? `${this.newItem.startTime} - ${this.newItem.endTime}` : '';

                this.itinerary.push({
                    id: Date.now(),
                    date: targetDate,
                    name: this.newItem.name,
                    category: this.newItem.category,
                    time: timeStr,
                    duration: '',
                    notes: this.newItem.notes,
                    travelTime: '30 min' // é è¨­å€¼
                });
                this.saveData();
                this.showAddModal = false;
                this.newItem = { name: '', category: 'æ™¯é»', startTime: '', endTime: '', notes: '' };
            },

            // åŒ¯ç‡
            convertCurrency(type) {
                if (type === 'IDR') {
                    this.calcHKD = (this.calcIDR * this.rate).toFixed(2);
                } else {
                    this.calcIDR = (this.calcHKD / this.rate).toFixed(0);
                }
            },

            // è³¼ç‰©ç›¸é—œ
            handleImageUpload(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        this.newShop.image = e.target.result; // Base64 string
                    };
                    reader.readAsDataURL(file);
                }
            },
            addShoppingItem() {
                if(!this.newShop.name) return;
                this.shoppingList.push({...this.newShop});
                this.saveData();
                this.showShoppingModal = false;
                this.newShop = { name: '', location: '', image: null };
            },
            deleteShoppingItem(index) {
                if(confirm('ç¢ºå®šåˆªé™¤ï¼Ÿ')) {
                    this.shoppingList.splice(index, 1);
                    this.saveData();
                }
            },

            // èŠ±è²»ç›¸é—œ
            getExpenseIcon(cat) {
                const map = { 'äº¤é€š': 'fa-taxi', 'é£²é£Ÿ': 'fa-utensils', 'ä½å®¿': 'fa-hotel', 'è³¼ç‰©': 'fa-bag-shopping', 'å…¶ä»–': 'fa-coins' };
                return `fa-solid ${map[cat] || 'fa-coins'}`;
            },
            addExpense() {
                if(!this.newExpense.name || !this.newExpense.amount) return;
                const today = new Date().toLocaleDateString();
                this.expenses.push({ ...this.newExpense, date: today });
                this.saveData();
                this.showExpenseModal = false;
                this.newExpense = { name: '', amount: '', category: 'é£²é£Ÿ', payment: 'ç¾é‡‘' };
            },
            deleteExpense(index) {
                if(confirm('åˆªé™¤æ­¤ç­†æ¶ˆè²»ç´€éŒ„ï¼Ÿ')) {
                    this.expenses.splice(index, 1);
                    this.saveData();
                }
            }
        }
    }).mount('#app');
</script>
</body>
</html>
